<div th:include="page/header"></div>
<div th:include="page/navbar_client"></div>
<script src="../js/vistas/form_profile.js"></script>
<link rel="stylesheet" href="../css/background03.css">

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>



<style>
    .card_img {
        margin: auto;
        width: 200px;
        height: 200px;
        border-radius: 100%;
        border-width: 5px;
    }

    .card_img img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }
</style>
<!-- 
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#staticBackdrop">
    Launch static backdrop modal
  </button>
  
  <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header text-center">
            <h5 class="modal-title " id="staticBackdropLabel">Actualizar foto de perfil</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
        <div class="modal-body text-center">
         <button id="buttonfile"  class="text-center text-primary btn bg-transparent">Cambiar foto de perfil</button>
         <hr>
         <a href="" class="text-danger text-center">Eliminar</a>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Understood</button>
        </div>
      </div>
    </div>
  </div> -->
  


<div class="container bootstrap snippet mx-auto mb-5">

    <div class="row">
        <div class="col-sm-12 col-md-5">
            <div class=" mt-5">
                <h2 th:text="${'Hola, '+client.nombre}" class="text-center mb-4"></h2>
                <div id="card" class="card_img avatar img-circle">
                    <img required id="previa" class="avatar img-circle img-thumbnail"
                        th:src="@{'/imagenes/'+${client.image}}" alt="user-image">
                </div>
                <form th:action="@{/cuenta/actualizarImagen}" method="post" enctype="multipart/form-data">
                    <input style="display: none;" type="file" name="file" id="file"
                        class="text-center center-block file-upload">
                    <div class="text-center mt-3">
                        <button id="buttonfile" class="btn btn-primary" type="button"> <i
                                class="fa-solid fa-retweet"></i>
                            Cambiar foto de perfil</button>
                        <button class="btn btn-success" type="submit"><i class="fa-solid fa-floppy-disk"></i>
                            Guardar</button>

                    </div>
                </form>

            </div>

            </hr><br>

            <div class="card text-center">
                <div class="card-header">
                    Datos Personales
                </div>
                <div class="card-body">
                    <div class="text-left">
                        <p style="margin-bottom: 0em;"><i class="fa-solid fa-user"></i> Nombre: <span
                                th:text="${client.nombre}"></span></p>
                        <p style="margin-bottom: 0em;"><i class="fa-solid fa-user"></i> Apellido: <span
                                th:text="${client.apellido}"></span></p>
                        <p style="margin-bottom: 0em;"><i class="fa-solid fa-phone"></i> Tel&eacute;fono: <span
                                th:text="${client.telefono}"></span></p>
                        <p style="margin-bottom: 0em;"><i class="fa-solid fa-envelope"></i> Correo: <span
                                th:text="${client.correo}"></span></p>
                        <p style="margin-bottom: 0em;"><i class="fa-solid fa-location-dot"></i> Direcci&oacute;n: <span
                                th:text="${client.direccion}"></span></p>
                    </div>
                </div>
                <div class="card-footer text-muted">
                    <a href="">CITAS AGENDADAS</a>
                </div>
            </div>
        </div>

        <div class="col-sm-12 col-md-7 mx-auto mt-5">
            <div class="card">
                <div class="card-header">
                    Datos Personales
                </div>
                <div class="card-body">
                    <div class="row bg-ligth">
                        <div class="col-sm-8 mx-auto">
                            <form th:action="@{/cuenta/actualizarTelefono}" method="post">
                                <div class="form-group">
                                    <div class="col-xs-6">
                                        <label for="first_name">
                                            <h5>Tel&eacute;fono</h5>
                                        </label>
                                        <input readonly type="text" th:value="${client.telefono}" class="form-control"
                                            name="telefono" id="telefono" placeholder="Numero telefonico">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button type="button" class="btn btn-primary" onclick="phoneAlert()"><i
                                            class="fa-solid fa-pen-to-square"></i> Editar</button>
                                    <button type="submit" class="btn btn-success ">
                                        <i class="fa-solid fa-floppy-disk"></i> Guardar</button>
                                </div>
                                <hr>
                            </form>
                            <form th:action="@{/cuenta/actualizarCorreo}" method="post">
                                <div class="form-group">
                                    <div class="col-xs-6">
                                        <label for="first_name">
                                            <h5>Correo</h5>
                                        </label>
                                        <input readonly type="text" th:value="${client.correo}" class="form-control"
                                            name="correo" id="correo" placeholder="Direccion de correo electronico">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button onclick="emailAlert()" type="button" class="btn btn-primary "><i
                                            class="fa-solid fa-pen-to-square"></i> Editar</button>
                                    <button type="submit" class="btn btn-success "><i
                                            class="fa-solid fa-floppy-disk"></i> Guardar </button>
                                </div>
                                <hr>
                            </form>

                            <form th:action="@{/cuenta/actualizarDireccion}" method="post">

                                <div class="form-group">
                                    <label for="">Direcci&oacute;n</label>
                                    <textarea readonly th:text="${client.direccion}" id="direccion" name="direccion"
                                        autocomplete="off" type="text" class="form-control">
                                                          </textarea>
                                </div>
                                <div class="mt-3">
                                    <button onclick="addressAlert()" type="button" class="btn btn-primary "> <i
                                            class="fa-solid fa-pen-to-square"></i> Editar</button>
                                    <button type="submit" class="btn btn-success "><i
                                            class="fa-solid fa-floppy-disk"></i> Guardar </button>
                                </div>
                                <hr>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--/row-->



    <div class="bg-light p-3 border-top">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-sm-12">
                    <div class="text-center">
                        <h4>Desarrolladores</h4>
                        <div><i class="fa-solid fa-user"></i> Mairon Jiménez</div>
                        <div><i class="fa-solid fa-user"></i> Fabricio Quesada</div>
                        <div><i class="fa-solid fa-user"></i> Steven Rojas</div>
                        <div><i class="fa-solid fa-user"></i> Joan Zuñiga</div>
                    </div>
                    <hr>
                </div>
                <div class="col-lg-4 col-sm-12">
                    <div class="text-center">
                        <h4>Institución</h4>
                        <div>Universidad de Costa Rica</div>
                    </div>
                    <hr>
                </div>
    
                <div class="col-lg-4 col-sm-12">
                    <div class="text-center">
                        <h4>Curso</h4>
                        <div>IF-4101</div>
                        <div>Lenguajes para Aplicaciones Comerciales</div>
                    </div>
                    <hr>
                </div>
    
            </div>
            <div class="container">
                <div class="row col-12">
                    <div class="mx-auto mt-3">
                        Copyright © <b>LAVACA$H</b> 2022. Todos los derechos reservados
                    </div>
                </div>
            </div>
        </div>

    <script>
        async function sweetAlert(nameData, url, componentId) {

            const {
                value: password
            } = await swal.fire({
                title: "PRECAUCI&Oacute;N",
                text: "Por motivos de seguridad ingresa la contraseña",
                input: 'text',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: "#218838",
                confirmButtonText: "Aceptar",
                cancelButtonText: "Cancelar",
                closeOnConfirm: false,
            })
            if (password) {
                var formdata = new FormData();
                formdata.append(nameData, password);
                $.ajax({
                    type: "POST",
                    url: url,
                    dataType: "JSON",
                    processData: false,
                    contentType: false,
                    async: true,
                    cache: false,
                    data: formdata
                }).done(function (validate) {
                    if (validate) {
                        document.getElementById(componentId).readOnly = false;
                        Swal.fire(
                            'success',
                            'Verificado exitosamente'
                        )
                    } else {
                        Swal.fire(
                            'error',
                            'Ingrese un dato valido!!'
                        )
                    }

                }).fail(function (validate) {
                    alert('Error!!');
                });
            }

        }

        async function phoneAlert() {
            var nameData = 'contrasena';
            var url = "http://localhost:8080/perfil/verificarContrasena";
            var componentId = 'telefono';
            sweetAlert(nameData, url, componentId);
        }

        async function emailAlert() {
            var nameData = 'contrasena';
            var url = "http://localhost:8080/perfil/verificarContrasena";
            var componentId = 'correo';
            sweetAlert(nameData, url, componentId);
        }

        async function addressAlert() {
            var nameData = 'contrasena';
            var url = "http://localhost:8080/perfil/verificarContrasena";
            var componentId = 'direccion';
            sweetAlert(nameData, url, componentId);
        }
    </script>